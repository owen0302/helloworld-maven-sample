- name: create installer directory
  file:
    path: '$HOME/{{installer_dir}}/'
    state: directory
- name: delete tomcat
  file:
    path: '$HOME/{{tomcat.dir}}/'
    state: absent
- name: download tomcat from artifactory
  get_url: 
    validate_certs: no
    url: "{{tomcat.base_url}}/apache-tomcat-{{tomcat.version}}.tar"
    dest: "$HOME/{{installer_dir}}"
- name: 'extract tarball $HOME/{{installer_dir}}/apache-tomcat-{{tomcat.version}}.tar'
  unarchive:
    remote_src: yes
    src: "$HOME/{{installer_dir}}/apache-tomcat-{{tomcat.version}}.tar"
    dest: '$HOME'
- name: rename tomcat directory
  shell: mv "apache-tomcat-{{tomcat.version}}" '{{tomcat.dir}}'
  args:
    chdir: "$HOME"
- name: replace config file
  template: src=setenv.sh.j2 dest='{{tomcat.dir}}/bin/setenv.sh'

